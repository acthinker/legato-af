<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<title>Legato: Yocto Install Notes</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<link href="fonts.css" rel="stylesheet" type="text/css" />
<link href="legato.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="jquery.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link rel="icon" type="image/png" href="favicon.ico" />
</head>
<body>
<div id="top"><!-- do not remove this div! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo">
    <img alt="Logo" src="legatoLogo.png"/>
    <div id="projectbrief">Simplifying M2M development</div>
  </td>
   <td>        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
</td>
 </tr>
 </tbody>
</table>
</div>
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('getstarted_install_notes.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Pages</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Yocto Install Notes </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><p>Here are some helpful tips for Yocto Linux working with Sierra Wireless devices:</p>
<p><a class="el" href="getstarted_install_notes.html#yoctoNoPwd">Log on Without Password</a> <br/>
 <a class="el" href="getstarted_install_notes.html#yoctoNFSRoot">Use nfs root</a> <br/>
 <a class="el" href="getstarted_install_notes.html#yoctoCDC">CDC-ECM for IP vs Ethernet</a> <br/>
 <a class="el" href="getstarted_install_notes.html#yoctoPrefIP">Setup Preferred IP</a> <br/>
 <a class="el" href="getstarted_install_notes.html#yoctoStaticIP">Setup Target Static IP</a> <br/>
 <a class="el" href="getstarted_install_notes.html#yoctoBSPTestReport">Setup using BSPTestReport.xls</a> <br/>
 <a class="el" href="getstarted_install_notes.html#yoctoReadWrite">Read/Write rootfs</a> <br/>
 <a class="el" href="getstarted_install_notes.html#yoctoNoDown">Disable New Package Download</a> <br/>
 <a class="el" href="getstarted_install_notes.html#yoctoDefUSB">Change Default USB Classes</a> <br/>
</p>
<h1><a class="anchor" id="yoctoNoPwd"></a>
Log on Without Password</h1>
<p>To log onto the target through the serial interface, log on as root with no password. This allows manual changes to other interfaces (e.g., USB if you want to run CDC-ECM).</p>
<h1><a class="anchor" id="yoctoNFSRoot"></a>
Use nfs root</h1>
<p>The file <b>meta-swi/meta-swi-mdm9x15/conf/machine/qcom-mdm9615.conf</b> contains examples if you need to include a lot of extra packages in your rootfs or if you build the debug version. See README.bsp for details. Remember to untar the generated rootfs to an exported file system. The file pointed to by the rootfs link contains the most recent root file system. Thereâ€™s more info available at <a href="https://www.kernel.org/doc/Documentation/filesystems/nfs/nfsroot.txt">https://www.kernel.org/doc/Documentation/filesystems/nfs/nfsroot.txt</a>.</p>
<h1><a class="anchor" id="yoctoCDC"></a>
CDC-ECM for IP vs Ethernet</h1>
<p>Using CDC-ECM for IP connections will cause the MAC address to change every reboot because the kernel allocates software-defined MAC addresses to interfaces. This may cause new connections to be detected by your host every time you reboot the device.</p>
<h1><a class="anchor" id="yoctoPrefIP"></a>
Setup Preferred IP</h1>
<p>Either boot with an Ethernet cable plugged in and let the device obtain an IP address using DHCP, or enable CDC-ECM and the micro-USB cable. You can then determine the IP address using <code>ifconfig</code> on the console or provide a fixed IP from your DHCP server. Then use <code>ssh</code> and <code>scp</code> to access the device and transfer files. Remember root has no password.</p>
<h1><a class="anchor" id="yoctoStaticIP"></a>
Setup Target Static IP</h1>
<p>Configure your target and development PC so it doesn't prompt for a password, run: <b>bin/configtargetssh</b> </p>
<p>It'll look like this: </p>
<pre class="fragment">dave@devbox:~/legato$ bin/configtargetssh 192.168.1.2
Generating new key pair... ---&gt;&gt;&gt; LEAVE THE PASSPHRASE EMPTY &lt;&lt;&lt;---
Generating public/private rsa key pair.
Enter passphrase (empty for no passphrase): 
Enter same passphrase again: 
Your identification has been saved in /home/dave/.ssh/id_rsa.legatoTarget.
Your public key has been saved in /home/dave/.ssh/id_rsa.legatoTarget.pub.
The key fingerprint is:
af:c5:e4:8c:7d:53:b4:a4:72:c8:67:f3:88:9c:3f:67 dave's key for Legato 
target devices.
The key's randomart image is:
+--[ RSA 2048]----+
|                 |
|                 |
|              o  |
|         . . + . |
|        S = * o  |
|         X B =   |
|        . @ + .  |
|         o o..E  |
|        .   .+   |
+-----------------+
/home/dave/.ssh/known_hosts updated.
Original contents retained as /home/dave/.ssh/known_hosts.old
Connecting to the target...  (ENTER TARGET'S ROOT PASSWORD WHENEVER 
PROMPTED FOR A PASSWORD)
(press ENTER if your target doesn't have a root password)
The authenticity of host '192.168.1.2 (192.168.1.2)' can't be established.
RSA key fingerprint is f2:2f:66:a5:14:20:bd:46:8f:a2:02:b3:99:6f:72:24.
Are you sure you want to continue connecting (yes/no)? yes
Warning: Permanently added '192.168.1.2' (RSA) to the list of known hosts.
root@192.168.1.2's password:
dave@devpc:~/legato$ 
</pre><h1><a class="anchor" id="yoctoBSPTestReport"></a>
Setup using BSPTestReport.xls</h1>
<p>This spreadsheet is used for instructions and reports to help set up different BSP features to test. Start with the Contents sheet.</p>
<h1><a class="anchor" id="yoctoReadWrite"></a>
Read/Write rootfs</h1>
<p>It's convenient right now to enable r/w to rootfs, but it will be moving to a read-only model soon. If you change the rootfs (e.g., in /etc, /lib, /bin), you may cripple your device and have to re-install your rootfs.</p>
<h1><a class="anchor" id="yoctoNoDown"></a>
Disable New Package Download</h1>
<p>The Yocto build defaults to disable new package downloads.</p>
<p>Enable downloading new packages over the Internet, modify:</p>
<p><code>&lt;build-dir&gt;/conf/local</code>.conf value <code>BB_NO_NETWORK</code> to "0" . The file is only present after a build has run once.</p>
<h1><a class="anchor" id="yoctoDefUSB"></a>
Change Default USB Classes</h1>
<p>During the boot sequence, startup scripts run the file <code>/etc/legato/usbsetup</code> that enumerates the USB types listed in <code>/etc/legato/usbmode</code>.</p>
<p>Override default types by creating your own <code>usbmode</code> file in <code>/mnt/flash/startup/usb</code>. The new file will take precedence over the old one. By default, the device will enumerate an ECM port, an ACM port for AT commands and USB audio.</p>
<hr/>
<p>Copyright (C) Sierra Wireless, Inc. 2014. All rights reserved. Use of this work is subject to license. </p>
</div></div><!-- contents -->
</div><!-- doc-content -->
   <div class="footer">
        <div>
            <a href="http://www.sierrawireless.com/">
                <img src="swi-ico-medium.png" width="24" alt="" />
                &nbsp;Sierra Wireless 2014
            </a>
            &nbsp;-&nbsp;
            Generated by Doxygen 1.8.6
        </div>
    </div>
</body>
</html>
